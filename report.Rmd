---
title: "Project Report"
output: html_document
authors: Ashley Anderson, Cameron Stocker, Hexiang Zhang, & Tyler Kruzan
---

#### Team Members:

Project Coordinator: Ashley Anderson

Cameron Stocker, Hexiang Zhang, & Tyler Kruzan

#### Dataset Link

Link to Dataset can be found on Kaggle or through this link: https://www.kaggle.com/PromptCloudHQ/imdb-data

#### Dataset Overview

```{r}
# Load dataset
movie = read.csv("IMDB-Movie-Data.csv")
```

#### Background

Our choice of a data set came from IMDb and includes data about the 1,000 most popular movies that came out between 2006 and 2016. Useful variables include Title, Director, Year, Runtime, Rating, Metascore, & Revenue. There are some messy variables such as Description, Actors, & Genre that contain lengthy character strings that will need to be parsed and cleaned or simply omitted from the final data we use.

IMDb, which stands for Internet Movie Database, is an online source for data associated with films, TV shows, video games, and other streamable content. For each title, users can find information relating to the starring cast, producers, and plot summaries, as well as both critic and fan reviews. As of May 2019, IMDb had 83 million registered users and approximately 6 million titles, including 516,726 feature films. IMDb ratings are based on user ratings on a scale from 1 to 10. The raw ratings are then filtered and weighted, creating a weighted mean rating for each film. The formula for calculating the weighted rating is $W = \frac{R*v + C*m}{v+m}$, where $R$ is the raw average, $v$ is the number of votes, $m$ is the minimum votes required to be included in the Top 250 (which is currently 25,000), and $C$ is the mean vote for the reports (which is currently 7.0). Below is a table of all variables in the dataset as well as a description for each variable. 

| Dataset Variables  | Description      |
| ------------------ | ---------------- |
| Rank               | Movie Rank Order |
| Title              | Tite of the film |
| Genre              | Comma separated-list of genres used to classify the film |
| Description        | Brief one-sentence movie summary |
| Director           | The name of the film's director |
| Actors             | A comma-separated list of the main stars of the film |
| Year               | The year that the film released as an integer. |
| Runtime (Minutes)  | The duration of the film in minutes.|
| Rating             | User rating for the movie 0-10 |
| Votes              | Number of votes |
| Revenue (Millions) | Movie revenue in millions |
| Metascore          | An aggregated average of critic scores. Values are between 0 and 100. Higher scores represent positive reviews. |

#### Pipeline

We begin by describing our plan of attack for the project. Beginning with the raw data set, we start with some exploration in order to see what needed to be fix or removed. We then move on to wrangling and cleaning the data based on what we found during the exploration.  

For analysis, we will examine a variety of questions. First we find which actors and directors are most commonly involved with successful movies. We define success by looking at a movie's rating, revenue, or metascore. We use the separate method in the 'Actors' column to move it into multiple columns. From there, we find the average movie rating and revenue on an actor and director specific basis.

We also dive into what factors are correlated with a high rating and revenue. We examine the genre, runtime, and votes to see if they have any significance in predicting rating or revenue. This can be done through ploting the dataset. 

We also examine relationships between different factors in a movie over time such as the year it was made and movie performances like runtime, votes, rating, and revenue to see how the components of top movies have changed over the years. This can also be done through plotting the dataset. 

Additionally, we explore the correlation of the variables we define as success: ratings, revenue, and metascore. We also compare these success variables to how fans recieved the movie by using the variable 'votes'. 

Lastly, we end with an analysis of the most successful directors and actors. We do this by taking the most "successful" directors and actors in terms of the success variables and exploring if there is any other reasons why they are so successful.  


####Data Exploration, Cleaning and Wrangling 

We can see from the structure of the data set that each variable type seems to be correct, so no changes were needed there. However, we noticed that there were some problems.

```{r}
library(tidyverse)
library(ggplot2)
str(movie)
summary(movie)
head(movie)
```

First, we noticed a few NAs in the data set and decided to explore more. As we can see below, there are quite a few NAs in the Revenue column. Since this variable is important for our definition of success, we

```{r}

colSums(is.na(movie))
movie <- movie %>% drop_na()

```

Second, some of the variables are messy or need renamed. We decided to drop the Rank and Description columns because these variables are difficult to use. Additionally, we do not believe they would add much value to our analysis. Next, we changed the variable names for Runtime and Revenue so that they did not include the units (minutes and millions) in the name. 

```{r}

movie = movie %>% select(-Rank, -Description)
names(movie)[c(6,9)] = c("Runtime", "Revenue")

```

Next, the genre variable shows multiple genres for each movie. In order for this variable to be useful, we need to separate them. We do this by separating the genres and then spreading the column out so each genre is a column. The movies recognized under a certain genre display a 1, those that are not display a 0.  

```{r}

movie = separate_rows(movie, Genre, sep = ",")
movie = movie %>%
  mutate(yesno = 1) %>%
  distinct %>%
  spread(Genre, yesno, fill = 0)

```

Lastly, the Actor variable shows multiple actors for each movie. Again, for this column to be useful, we will somehow need to isolate each actor fo reach movie. We do this by separating the "Actors" column into four different columns: Actor1, Actor2, Actor3, and Actor4.  

```{r}

movie = movie %>% separate("Actors", sep = ",", into = c("Actor1", "Actor2", "Actor3", "Actor4"))

```


####Exploratory Data Analysis

Which actors and directors are most successful?
```{r}

```

What factors are correlated with high ratings and revenue?
```{r}

movie2 = movie %>%
    group_by(Runtime) %>%
    summarize(mean_rev = mean(Revenue))

ggplot(movie2, aes(x = Runtime, y = mean_rev)) + geom_point() + labs(title = "Average Revenue of Movies for each Runtime") + xlab("Movie Runtime (min)") + ylab("Revenue (mil)")

```

What relationships are there in movie performances over time?
```{r}

```

What genres are most successful?
```{r fig.height=5, fig.width=10}

genres <- colnames(movie[,13:32])
movie2<- movie %>%
  select(genres,"Revenue","Metascore","Rating") 

movie3 <- data.frame("Genre"=genres, "Avg_Revenue"=NA, "Avg_Metascore"=NA, "Avg_Rating"=NA)
for(i in 1:20){
  total1 <- 0
  total2 <- 0
  total3 <- 0
  n <- 0
  for(j in 1:nrow(movie2)){
    if(movie2[j,i]==1){
      total1 <- total1 + movie2$Revenue[j]
      total2 <- total2 + movie2$Metascore[j]
      total3 <- total3 + movie2$Rating[j]
      n <- n + 1
    }
  }
  avg1 <- total1/n
  movie3$Avg_Revenue[i]=avg1
  avg2 <- total2/n
  movie3$Avg_Metascore[i]=avg2
  avg3 <- total3/n
  movie3$Avg_Rating[i]=avg3
}

g1 <- movie3 %>%
  arrange(desc(Avg_Revenue)) %>%
  ggplot(aes(x=reorder(Genre, Avg_Revenue),y=Avg_Revenue, fill=Genre)) + geom_bar(stat='identity') +
  coord_flip() + theme(legend.position = "none") + geom_text(aes(label=round(Avg_Revenue, digits=1)), position=position_dodge(width=0.9), hjust=1) +labs(title="Average Revenue by Genre", x="Genre", y="Average Revenue")

g2 <- movie3 %>%
  arrange(desc(Avg_Metascore)) %>%
  ggplot(aes(x=reorder(Genre, Avg_Metascore),y=Avg_Metascore, fill=Genre)) + geom_bar(stat='identity') +
  coord_flip() + theme(legend.position = "none") + 
  geom_text(aes(label=round(Avg_Metascore, digits=1)), position=position_dodge(width=0.9), hjust=1) +
  labs(title="Average Metascore by Genre", x="Genre", y="Average Metascore")


g3 <- movie3 %>%
  arrange(desc(Avg_Rating)) %>%
  ggplot(aes(x=reorder(Genre, Avg_Rating),y=Avg_Rating, fill=Genre)) + geom_bar(stat='identity')+
  coord_flip() + theme(legend.position = "none") + 
  geom_text(aes(label=round(Avg_Rating, digits=1)), position=position_dodge(width=0.9), hjust=1) +
  labs(title="Average Ratings by Genre", x="Genre", y="Average Ratings")

#install.packages("grid")
library(grid)
grid.newpage()

pushViewport(viewport(layout = grid.layout(nrow = 1, ncol = 3)))

define_region <- function(row, col){
  viewport(layout.pos.row = row, layout.pos.col = col)
} 

print(g1, vp = define_region(row = 1, col = 1)) 
print(g2, vp = define_region(row = 1, col = 2))
print(g3, vp = define_region(row = 1, col = 3))

```

Analysis of the most successful directors and actors
```{r}

```

####Conclusion



####Team Contribution

Ashley:

Tyler:

Hexiang:

Cameron: